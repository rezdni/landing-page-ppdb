<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>edit calon</title>
        <link rel="stylesheet" href="../../assets/styles/styles.css" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
            integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <!-- CSS Popup -->
        <link rel="stylesheet" href="../../assets/styles/popup.css" />
    </head>
    <body>
        <!-- Menu mobile -->
        <div class="menu-mobile">
            <button class="menu-close">X</button>
            <a href="index.html">
                <i class="fa-solid fa-house"></i>
                <span>Dashboard</span>
            </a>

            <a href="data-siswa.html">
                <i class="fa-solid fa-user-group"></i>
                <span>Data Siswa</span>
            </a>

            <a href="data-pendaftar.html">
                <i class="fas fa-chart-bar"></i>
                <span>Data Pendaftar</span>
            </a>

            <a href="pengelola-pengumunan.html">
                <i class="material-symbols-outlined" style="font-size: 16px"
                    >campaign</i
                >
                <span>Pengumunan</span>
            </a>

            <a href="kelola-pengguna.html">
                <i class="fa-solid fa-users"></i>
                <span>Kelola Pengguna</span>
            </a>

            <a href="../../logout.php">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
        <!-- End menu MObile -->

        <!-- sidebar -->
        <div class="sidebar">
            <ul class="menu">
                <li>
                    <a href="#">
                        <i class="fa-solid fa-bars"></i>
                        <span>Menu</span>
                    </a>
                </li>
                <li>
                    <a href="index.html">
                        <i class="fa-solid fa-house"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="data-siswa.html">
                        <i class="fa-solid fa-user-group"></i>
                        <span>Data Siswa</span>
                    </a>
                </li>
                <li>
                    <a href="data-pendaftar.html">
                        <i class="fas fa-chart-bar"></i>
                        <span>Data Pendaftar</span>
                    </a>
                </li>
                <li>
                    <a href="pengelola-pengumunan.html">
                        <i
                            class="material-symbols-outlined"
                            style="font-size: 25px"
                            >campaign</i
                        >
                        <span>Pengumunan</span>
                    </a>
                </li>
                <li>
                    <a href="kelola-pengguna.html">
                        <i class="fa-solid fa-users"></i>
                        <span>Kelola Pengguna</span>
                    </a>
                </li>
                <li class="logout">
                    <a href="../../logout.php">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </li>
            </ul>
        </div>
        <!-- sidebar -->
        <div class="main--content">
            <div class="header--wrapper">
                <div class="menu-btn">
                    <span class="material-symbols-outlined"> menu </span>
                </div>
                <div class="header--title">
                    <img src="../../assets/images/logo.png" alt="" />
                    <div class="teks">
                        <span>SMA AL FASNAH</span>
                        <h2>Data Siswa</h2>
                    </div>
                </div>
                <!-- search -->
            </div>
            <!-- end sidebar -->
            <!-- biodata status -->
            <div class="list--wrapper">
                <h3 class="main--title">Biodata Siswa</h3>
                <div class="list--container">
                    <div class="tabel-biodata" id="siswa">
                        <table class="list-biodata">
                            <thead>
                                <tr>
                                    <td>Nama</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Tanggal Lahir</td>
                                    <td id="tgl-lahir">:</td>
                                </tr>
                                <tr>
                                    <td>NISN</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Jenis Kelamin</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Agama</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Asal Sekolah</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Kewarganegaraan</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Golongan Darah</td>
                                    <td>:</td>
                                </tr>
                            </thead>
                        </table>
                        <table class="list-biodata">
                            <thead>
                                <tr>
                                    <td>Alamat</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Provinsi</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Kota/Kabupaten</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Kecamatan</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Kelurahan</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Kode Pos</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>No Telepon</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Jurusan</td>
                                    <td>:</td>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <a href="/views/admin/data-pendaftar.html" class="btn-ubah">
                    Perbarui
                </a>
            </div>

            <div class="list--wrapper">
                <h3 class="main--title">Data Orang Tua</h3>
                <div class="list--container">
                    <div class="tabel-biodata" id="ortu">
                        <table class="list-biodata">
                            <thead>
                                <tr>
                                    <td>Nama</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>No. Telepon</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Pekerjaan</td>
                                    <td>:</td>
                                </tr>
                                <tr>
                                    <td>Alamat</td>
                                    <td>:</td>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <a href="/views/admin/data-orang-tua.html" class="btn-ubah">
                    Perbarui
                </a>
            </div>

            <!-- Dokumen -->
            <div class="list--wrapper">
                <h3 class="main--title">Dokumen Pendukung</h3>
                <form action="">
                    <div class="list--container">
                        <div class="tabel-berkas">
                            <div class="dokumen">
                                <div class="preview" id="view-ijasah">
                                    <span class="material-symbols-outlined">
                                        description
                                    </span>
                                </div>
                                <div class="upload-btn">
                                    <label for="ijasah">
                                        <span class="material-symbols-outlined">
                                            upload
                                        </span>
                                        Ijazah</label
                                    >
                                    <input
                                        type="file"
                                        onchange="previewInputFile(this.parentElement.parentElement)"
                                        name="ijasah"
                                        id="ijasah"
                                    />
                                </div>
                            </div>
                            <div class="dokumen">
                                <div class="preview" id="view-foto_profil">
                                    <span class="material-symbols-outlined">
                                        description
                                    </span>
                                </div>
                                <div class="upload-btn">
                                    <label for="foto-profil">
                                        <span class="material-symbols-outlined">
                                            upload
                                        </span>
                                        Pas foto</label
                                    >
                                    <input
                                        type="file"
                                        onchange="previewInputFile(this.parentElement.parentElement)"
                                        name="foto-profil"
                                        id="foto-profil"
                                    />
                                </div>
                            </div>
                            <div class="dokumen">
                                <div class="preview" id="view-dokumen_lainnya">
                                    <span class="material-symbols-outlined">
                                        description
                                    </span>
                                </div>
                                <div class="upload-btn">
                                    <label for="dokumen-lainnya">
                                        <span class="material-symbols-outlined">
                                            upload
                                        </span>
                                        Berkas lain</label
                                    >
                                    <input
                                        type="file"
                                        onchange="previewInputFile(this.parentElement.parentElement)"
                                        name="dokumen-lainnya"
                                        id="dokumen-lainnya"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>
                    <button
                        type="submit"
                        name="simpan"
                        id="simpan"
                        class="btn-ubah"
                        onclick="kirimForm('berkas', event, nisCalon, this);"
                    >
                        Perbarui
                    </button>
                </form>
            </div>
        </div>

        <!-- end biodata status -->
        <!-- Popup Notifikasi -->
        <div class="popup">
            <div class="overlay">
                <div class="popup-content">
                    <h2 class="popup-title">This is popup title</h2>
                    <p class="popup-msg">
                        Lorem ipsum, dolor sit amet consectetur adipisicing
                        elit. Veniam blanditiis magnam aut harum et aperiam ea
                        eum nulla? Sed, odit. Voluptatem sed debitis ullam
                        aspernatur aliquam tempora ab magnam illum.
                    </p>
                    <div class="controls">
                        <button class="submit-btn">Submit</button>
                        <button class="close-btn">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- end Popup Notifikasi -->
        <script src="../../assets/scripts/admin.js"></script>
        <script src="../../assets/scripts/popup.js"></script>
        <script src="../../assets/scripts/cek-sesi.js"></script>
        <script>
            // Convert tanggal lahir
            let tanggalLahir = document.getElementById("tgl-lahir");

            // Cek url
            const getUrlMethod = new URLSearchParams(window.location.search);
            let nisCalon = getUrlMethod.get("nis");
            let statusPerubahan = getUrlMethod.get("status_change");

            // Proses data calon
            async function prosesDataCalon(tipeData) {
                try {
                    let td = document.querySelectorAll(
                        "#" + tipeData + " .list-biodata td:nth-child(2)"
                    );
                    const biodata =
                        tipeData == "siswa"
                            ? await reqCalon(nisCalon)
                            : await reqOrtuCalon(nisCalon);

                    for (let i = 0; i < td.length; i++) {
                        td[i].innerText = ": " + biodata[i];
                    }
                } catch (kesalahan) {
                    if (kesalahan.code !== 404) {
                        showPopup("Kesalahan", "Terjadi kesalahan", "", "Oke");
                        console.log(kesalahan.message);
                    }
                }
            }

            // Muat semua data
            function muatData() {
                prosesDataCalon("siswa");
                prosesDataCalon("ortu");
                reqDocs(nisCalon);
            }

            // Muat semua data
            window.onload = function () {
                muatData();
                aturLink("?nis=" + nisCalon);

                statusPerubahan
                    ? showPopup("Berhasil", statusPerubahan, "", "Oke")
                    : "";
            };

            cekSesi();
        </script>
    </body>
</html>
